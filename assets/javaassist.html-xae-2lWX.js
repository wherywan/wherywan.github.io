import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as n,c as a,e as l}from"./app-hoN0JGLf.js";const p={},o=l(`<h1 id="javaassist" tabindex="-1"><a class="header-anchor" href="#javaassist"><span>javaassist</span></a></h1><p>开放源代码JBoss 应用服务器项目，一个开源的分析、编辑和创建Java字节码的类库</p><ul><li>简单，而且快速；</li><li>直接使用java编码的形式，而不需要了解虚拟机指令，就能动态改变类的结构，或者动态生成类；</li></ul><h2 id="样例" tabindex="-1"><a class="header-anchor" href="#样例"><span>样例</span></a></h2><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki light-plus" style="background-color:#FFFFFF;color:#000000;" tabindex="0"><code><span class="line"><span style="color:#0000FF;">package</span><span style="color:#000000;"> com.an.bytecode.javaassist;</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#0000FF;">import</span><span style="color:#000000;"> javassist.*;</span></span>
<span class="line"><span style="color:#0000FF;">import</span><span style="color:#000000;"> java.io.File;</span></span>
<span class="line"><span style="color:#0000FF;">import</span><span style="color:#000000;"> java.io.FileOutputStream;</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">/**</span></span>
<span class="line"><span style="color:#008000;"> * @description:</span></span>
<span class="line"><span style="color:#008000;"> * </span><span style="color:#0000FF;">@author</span><span style="color:#008000;">: anpeiyong</span></span>
<span class="line"><span style="color:#008000;"> * @date: Created in 2020/4/7 11:25</span></span>
<span class="line"><span style="color:#008000;"> * </span><span style="color:#0000FF;">@since</span><span style="color:#008000;">:</span></span>
<span class="line"><span style="color:#008000;"> */</span></span>
<span class="line"><span style="color:#0000FF;">public</span><span style="color:#0000FF;"> class</span><span style="color:#267F99;"> JavaAssistTest</span><span style="color:#000000;"> {</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#0000FF;">    public</span><span style="color:#0000FF;"> static</span><span style="color:#267F99;"> void</span><span style="color:#795E26;"> main</span><span style="color:#000000;">(</span><span style="color:#267F99;">String</span><span style="color:#000000;">[] </span><span style="color:#001080;">args</span><span style="color:#000000;">) </span><span style="color:#0000FF;">throws</span><span style="color:#267F99;"> Exception</span><span style="color:#000000;"> {</span></span>
<span class="line"><span style="color:#008000;">        //CtClass对象容器</span></span>
<span class="line"><span style="color:#267F99;">        ClassPool</span><span style="color:#001080;"> classPool</span><span style="color:#000000;">=</span><span style="color:#001080;">ClassPool</span><span style="color:#000000;">.</span><span style="color:#795E26;">getDefault</span><span style="color:#000000;">();</span></span>
<span class="line"><span style="color:#008000;">        //CtClass对象容器中创建一个public的JATest类</span></span>
<span class="line"><span style="color:#267F99;">        CtClass</span><span style="color:#001080;"> jATestClazz</span><span style="color:#000000;">=</span><span style="color:#001080;">classPool</span><span style="color:#000000;">.</span><span style="color:#795E26;">makeClass</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;com.an.bytecode.javaassist.JATest&quot;</span><span style="color:#000000;">);</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        //***属性操作</span></span>
<span class="line"><span style="color:#008000;">        //JATest类中添加private int id</span></span>
<span class="line"><span style="color:#267F99;">        CtField</span><span style="color:#001080;"> ctIdField</span><span style="color:#000000;">=</span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> CtField</span><span style="color:#000000;">(</span><span style="color:#001080;">classPool</span><span style="color:#000000;">.</span><span style="color:#795E26;">getCtClass</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;int&quot;</span><span style="color:#000000;">),</span><span style="color:#A31515;">&quot;id&quot;</span><span style="color:#000000;">,jATestClazz);</span></span>
<span class="line"><span style="color:#001080;">        ctIdField</span><span style="color:#000000;">.</span><span style="color:#795E26;">setModifiers</span><span style="color:#000000;">(</span><span style="color:#001080;">Modifier</span><span style="color:#000000;">.</span><span style="color:#001080;">PRIVATE</span><span style="color:#000000;">);</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addField</span><span style="color:#000000;">(ctIdField);</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        //JATest类中添加private String username</span></span>
<span class="line"><span style="color:#267F99;">        CtField</span><span style="color:#001080;"> ctUserNameField</span><span style="color:#000000;">=</span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> CtField</span><span style="color:#000000;">(</span><span style="color:#001080;">classPool</span><span style="color:#000000;">.</span><span style="color:#795E26;">getCtClass</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;java.lang.String&quot;</span><span style="color:#000000;">),</span><span style="color:#A31515;">&quot;username&quot;</span><span style="color:#000000;">,jATestClazz);</span></span>
<span class="line"><span style="color:#001080;">        ctUserNameField</span><span style="color:#000000;">.</span><span style="color:#795E26;">setModifiers</span><span style="color:#000000;">(</span><span style="color:#001080;">Modifier</span><span style="color:#000000;">.</span><span style="color:#001080;">PRIVATE</span><span style="color:#000000;">);</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addField</span><span style="color:#000000;">(ctUserNameField);</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        //添加getter,setter方法</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addMethod</span><span style="color:#000000;">(</span><span style="color:#001080;">CtNewMethod</span><span style="color:#000000;">.</span><span style="color:#795E26;">getter</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;getId&quot;</span><span style="color:#000000;">,ctIdField));</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addMethod</span><span style="color:#000000;">(</span><span style="color:#001080;">CtNewMethod</span><span style="color:#000000;">.</span><span style="color:#795E26;">getter</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;setId&quot;</span><span style="color:#000000;">,ctIdField));</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addMethod</span><span style="color:#000000;">(</span><span style="color:#001080;">CtNewMethod</span><span style="color:#000000;">.</span><span style="color:#795E26;">getter</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;getUsername&quot;</span><span style="color:#000000;">,ctUserNameField));</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addMethod</span><span style="color:#000000;">(</span><span style="color:#001080;">CtNewMethod</span><span style="color:#000000;">.</span><span style="color:#795E26;">getter</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;setUsername&quot;</span><span style="color:#000000;">,ctUserNameField));</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        //添加构造函数</span></span>
<span class="line"><span style="color:#267F99;">        CtConstructor</span><span style="color:#001080;"> ctConstructor</span><span style="color:#000000;">=</span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> CtConstructor</span><span style="color:#000000;">(</span><span style="color:#AF00DB;">new</span><span style="color:#267F99;"> CtClass</span><span style="color:#000000;">[]{},jATestClazz);</span></span>
<span class="line"><span style="color:#008000;">        //添加构造函数方法体</span></span>
<span class="line"><span style="color:#267F99;">        StringBuffer</span><span style="color:#001080;"> sb</span><span style="color:#000000;"> = </span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> StringBuffer</span><span style="color:#000000;">();</span></span>
<span class="line"><span style="color:#001080;">        sb</span><span style="color:#000000;">.</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;{</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">&quot;</span><span style="color:#000000;">).</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;this.id = 27;</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">&quot;</span><span style="color:#000000;">).</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;this.username=</span><span style="color:#EE0000;">\\&quot;</span><span style="color:#A31515;">carl</span><span style="color:#EE0000;">\\&quot;</span><span style="color:#A31515;">;</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">}&quot;</span><span style="color:#000000;">);</span></span>
<span class="line"><span style="color:#001080;">        ctConstructor</span><span style="color:#000000;">.</span><span style="color:#795E26;">setBody</span><span style="color:#000000;">(</span><span style="color:#001080;">sb</span><span style="color:#000000;">.</span><span style="color:#795E26;">toString</span><span style="color:#000000;">());</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addConstructor</span><span style="color:#000000;">(ctConstructor);</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        // 添加自定义方法</span></span>
<span class="line"><span style="color:#267F99;">        CtMethod</span><span style="color:#001080;"> method</span><span style="color:#000000;"> = </span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> CtMethod</span><span style="color:#000000;">(</span><span style="color:#001080;">CtClass</span><span style="color:#000000;">.</span><span style="color:#001080;">voidType</span><span style="color:#000000;">, </span><span style="color:#A31515;">&quot;say&quot;</span><span style="color:#000000;">, </span><span style="color:#AF00DB;">new</span><span style="color:#267F99;"> CtClass</span><span style="color:#000000;">[]{}, jATestClazz);</span></span>
<span class="line"><span style="color:#001080;">        method</span><span style="color:#000000;">.</span><span style="color:#795E26;">setModifiers</span><span style="color:#000000;">(</span><span style="color:#001080;">Modifier</span><span style="color:#000000;">.</span><span style="color:#001080;">PUBLIC</span><span style="color:#000000;">);</span></span>
<span class="line"><span style="color:#267F99;">        StringBuffer</span><span style="color:#001080;"> printSb</span><span style="color:#000000;"> = </span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> StringBuffer</span><span style="color:#000000;">();</span></span>
<span class="line"><span style="color:#001080;">        printSb</span><span style="color:#000000;">.</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;{</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">System.out.println(</span><span style="color:#EE0000;">\\&quot;</span><span style="color:#A31515;">begin!</span><span style="color:#EE0000;">\\&quot;</span><span style="color:#A31515;">);</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">&quot;</span><span style="color:#000000;">)</span></span>
<span class="line"><span style="color:#000000;">                .</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;System.out.println(id);</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">&quot;</span><span style="color:#000000;">)</span></span>
<span class="line"><span style="color:#000000;">                .</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;System.out.println(username);</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">&quot;</span><span style="color:#000000;">)</span></span>
<span class="line"><span style="color:#000000;">                .</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;System.out.println(</span><span style="color:#EE0000;">\\&quot;</span><span style="color:#A31515;">end!</span><span style="color:#EE0000;">\\&quot;</span><span style="color:#A31515;">);</span><span style="color:#EE0000;">\\n</span><span style="color:#A31515;">&quot;</span><span style="color:#000000;">)</span></span>
<span class="line"><span style="color:#000000;">                .</span><span style="color:#795E26;">append</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;}&quot;</span><span style="color:#000000;">);</span></span>
<span class="line"><span style="color:#001080;">        method</span><span style="color:#000000;">.</span><span style="color:#795E26;">setBody</span><span style="color:#000000;">(</span><span style="color:#001080;">printSb</span><span style="color:#000000;">.</span><span style="color:#795E26;">toString</span><span style="color:#000000;">());</span></span>
<span class="line"><span style="color:#001080;">        jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">addMethod</span><span style="color:#000000;">(method);</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        //生成一个Class对象</span></span>
<span class="line"><span style="color:#267F99;">        Class</span><span style="color:#000000;">&lt;</span><span style="color:#0000FF;">?</span><span style="color:#000000;">&gt; </span><span style="color:#001080;">clazz</span><span style="color:#000000;">=</span><span style="color:#001080;">jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">toClass</span><span style="color:#000000;">();</span></span>
<span class="line"><span style="color:#267F99;">        Object</span><span style="color:#001080;"> object</span><span style="color:#000000;">=</span><span style="color:#001080;">clazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">newInstance</span><span style="color:#000000;">();</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        //反射执行方法</span></span>
<span class="line"><span style="color:#001080;">        clazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">getMethod</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;say&quot;</span><span style="color:#000000;">,</span><span style="color:#AF00DB;">new</span><span style="color:#267F99;"> Class</span><span style="color:#000000;">[]{}).</span><span style="color:#795E26;">invoke</span><span style="color:#000000;">(object,</span><span style="color:#AF00DB;">new</span><span style="color:#267F99;"> Object</span><span style="color:#000000;">[]{});</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;">        //将生成的class写入文件中</span></span>
<span class="line"><span style="color:#267F99;">        FileOutputStream</span><span style="color:#001080;"> fileOutputStream</span><span style="color:#000000;">=</span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> FileOutputStream</span><span style="color:#000000;">(</span><span style="color:#AF00DB;">new</span><span style="color:#795E26;"> File</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;JATest.class&quot;</span><span style="color:#000000;">));</span></span>
<span class="line"><span style="color:#001080;">        fileOutputStream</span><span style="color:#000000;">.</span><span style="color:#795E26;">write</span><span style="color:#000000;">(</span><span style="color:#001080;">jATestClazz</span><span style="color:#000000;">.</span><span style="color:#795E26;">toBytecode</span><span style="color:#000000;">());</span></span>
<span class="line"><span style="color:#001080;">        fileOutputStream</span><span style="color:#000000;">.</span><span style="color:#795E26;">close</span><span style="color:#000000;">();</span></span>
<span class="line"><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),e=[o];function t(c,r){return n(),a("div",null,e)}const d=s(p,[["render",t],["__file","javaassist.html.vue"]]),v=JSON.parse('{"path":"/note/java/javaassist.html","title":"javaassist","lang":"zh-CN","frontmatter":{"description":"javaassist 开放源代码JBoss 应用服务器项目，一个开源的分析、编辑和创建Java字节码的类库 简单，而且快速； 直接使用java编码的形式，而不需要了解虚拟机指令，就能动态改变类的结构，或者动态生成类； 样例","head":[["meta",{"property":"og:url","content":"https://wherywan.github.io/note/java/javaassist.html"}],["meta",{"property":"og:site_name","content":"HONG_JI"}],["meta",{"property":"og:title","content":"javaassist"}],["meta",{"property":"og:description","content":"javaassist 开放源代码JBoss 应用服务器项目，一个开源的分析、编辑和创建Java字节码的类库 简单，而且快速； 直接使用java编码的形式，而不需要了解虚拟机指令，就能动态改变类的结构，或者动态生成类； 样例"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-11-01T09:29:34.000Z"}],["meta",{"property":"article:author","content":"wanhongji"}],["meta",{"property":"article:modified_time","content":"2023-11-01T09:29:34.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"javaassist\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-11-01T09:29:34.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"wanhongji\\"}]}"]]},"headers":[{"level":2,"title":"样例","slug":"样例","link":"#样例","children":[]}],"git":{"createdTime":1698830974000,"updatedTime":1698830974000,"contributors":[{"name":"wanhongji","email":"wherywan@163.com","commits":1}]},"readingTime":{"minutes":1.14,"words":341},"filePathRelative":"note/java/javaassist.md","localizedDate":"2023年11月1日","excerpt":"\\n<p>开放源代码JBoss 应用服务器项目，一个开源的分析、编辑和创建Java字节码的类库</p>\\n<ul>\\n<li>简单，而且快速；</li>\\n<li>直接使用java编码的形式，而不需要了解虚拟机指令，就能动态改变类的结构，或者动态生成类；</li>\\n</ul>\\n<h2>样例</h2>\\n<div class=\\"language-java line-numbers-mode\\" data-ext=\\"java\\" data-title=\\"java\\"><pre class=\\"shiki light-plus\\" style=\\"background-color:#FFFFFF;color:#000000\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#0000FF\\">package</span><span style=\\"color:#000000\\"> com.an.bytecode.javaassist;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#0000FF\\">import</span><span style=\\"color:#000000\\"> javassist.*;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#0000FF\\">import</span><span style=\\"color:#000000\\"> java.io.File;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#0000FF\\">import</span><span style=\\"color:#000000\\"> java.io.FileOutputStream;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">/**</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\"> * @description:</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\"> * </span><span style=\\"color:#0000FF\\">@author</span><span style=\\"color:#008000\\">: anpeiyong</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\"> * @date: Created in 2020/4/7 11:25</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\"> * </span><span style=\\"color:#0000FF\\">@since</span><span style=\\"color:#008000\\">:</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\"> */</span></span>\\n<span class=\\"line\\"><span style=\\"color:#0000FF\\">public</span><span style=\\"color:#0000FF\\"> class</span><span style=\\"color:#267F99\\"> JavaAssistTest</span><span style=\\"color:#000000\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#0000FF\\">    public</span><span style=\\"color:#0000FF\\"> static</span><span style=\\"color:#267F99\\"> void</span><span style=\\"color:#795E26\\"> main</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#267F99\\">String</span><span style=\\"color:#000000\\">[] </span><span style=\\"color:#001080\\">args</span><span style=\\"color:#000000\\">) </span><span style=\\"color:#0000FF\\">throws</span><span style=\\"color:#267F99\\"> Exception</span><span style=\\"color:#000000\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //CtClass对象容器</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        ClassPool</span><span style=\\"color:#001080\\"> classPool</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#001080\\">ClassPool</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getDefault</span><span style=\\"color:#000000\\">();</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //CtClass对象容器中创建一个public的JATest类</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        CtClass</span><span style=\\"color:#001080\\"> jATestClazz</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#001080\\">classPool</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">makeClass</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"com.an.bytecode.javaassist.JATest\\"</span><span style=\\"color:#000000\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //***属性操作</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //JATest类中添加private int id</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        CtField</span><span style=\\"color:#001080\\"> ctIdField</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> CtField</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">classPool</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getCtClass</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"int\\"</span><span style=\\"color:#000000\\">),</span><span style=\\"color:#A31515\\">\\"id\\"</span><span style=\\"color:#000000\\">,jATestClazz);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        ctIdField</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">setModifiers</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">Modifier</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#001080\\">PRIVATE</span><span style=\\"color:#000000\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addField</span><span style=\\"color:#000000\\">(ctIdField);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //JATest类中添加private String username</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        CtField</span><span style=\\"color:#001080\\"> ctUserNameField</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> CtField</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">classPool</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getCtClass</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"java.lang.String\\"</span><span style=\\"color:#000000\\">),</span><span style=\\"color:#A31515\\">\\"username\\"</span><span style=\\"color:#000000\\">,jATestClazz);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        ctUserNameField</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">setModifiers</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">Modifier</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#001080\\">PRIVATE</span><span style=\\"color:#000000\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addField</span><span style=\\"color:#000000\\">(ctUserNameField);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //添加getter,setter方法</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addMethod</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">CtNewMethod</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getter</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"getId\\"</span><span style=\\"color:#000000\\">,ctIdField));</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addMethod</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">CtNewMethod</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getter</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"setId\\"</span><span style=\\"color:#000000\\">,ctIdField));</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addMethod</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">CtNewMethod</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getter</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"getUsername\\"</span><span style=\\"color:#000000\\">,ctUserNameField));</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addMethod</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">CtNewMethod</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getter</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"setUsername\\"</span><span style=\\"color:#000000\\">,ctUserNameField));</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //添加构造函数</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        CtConstructor</span><span style=\\"color:#001080\\"> ctConstructor</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> CtConstructor</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#267F99\\"> CtClass</span><span style=\\"color:#000000\\">[]{},jATestClazz);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //添加构造函数方法体</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        StringBuffer</span><span style=\\"color:#001080\\"> sb</span><span style=\\"color:#000000\\"> = </span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> StringBuffer</span><span style=\\"color:#000000\\">();</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        sb</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"{</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">\\"</span><span style=\\"color:#000000\\">).</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"this.id = 27;</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">\\"</span><span style=\\"color:#000000\\">).</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"this.username=</span><span style=\\"color:#EE0000\\">\\\\\\"</span><span style=\\"color:#A31515\\">carl</span><span style=\\"color:#EE0000\\">\\\\\\"</span><span style=\\"color:#A31515\\">;</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">}\\"</span><span style=\\"color:#000000\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        ctConstructor</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">setBody</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">sb</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">toString</span><span style=\\"color:#000000\\">());</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addConstructor</span><span style=\\"color:#000000\\">(ctConstructor);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        // 添加自定义方法</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        CtMethod</span><span style=\\"color:#001080\\"> method</span><span style=\\"color:#000000\\"> = </span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> CtMethod</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">CtClass</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#001080\\">voidType</span><span style=\\"color:#000000\\">, </span><span style=\\"color:#A31515\\">\\"say\\"</span><span style=\\"color:#000000\\">, </span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#267F99\\"> CtClass</span><span style=\\"color:#000000\\">[]{}, jATestClazz);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        method</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">setModifiers</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">Modifier</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#001080\\">PUBLIC</span><span style=\\"color:#000000\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        StringBuffer</span><span style=\\"color:#001080\\"> printSb</span><span style=\\"color:#000000\\"> = </span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> StringBuffer</span><span style=\\"color:#000000\\">();</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        printSb</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"{</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">System.out.println(</span><span style=\\"color:#EE0000\\">\\\\\\"</span><span style=\\"color:#A31515\\">begin!</span><span style=\\"color:#EE0000\\">\\\\\\"</span><span style=\\"color:#A31515\\">);</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">\\"</span><span style=\\"color:#000000\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\">                .</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"System.out.println(id);</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">\\"</span><span style=\\"color:#000000\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\">                .</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"System.out.println(username);</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">\\"</span><span style=\\"color:#000000\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\">                .</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"System.out.println(</span><span style=\\"color:#EE0000\\">\\\\\\"</span><span style=\\"color:#A31515\\">end!</span><span style=\\"color:#EE0000\\">\\\\\\"</span><span style=\\"color:#A31515\\">);</span><span style=\\"color:#EE0000\\">\\\\n</span><span style=\\"color:#A31515\\">\\"</span><span style=\\"color:#000000\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\">                .</span><span style=\\"color:#795E26\\">append</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"}\\"</span><span style=\\"color:#000000\\">);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        method</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">setBody</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">printSb</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">toString</span><span style=\\"color:#000000\\">());</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">addMethod</span><span style=\\"color:#000000\\">(method);</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //生成一个Class对象</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        Class</span><span style=\\"color:#000000\\">&lt;</span><span style=\\"color:#0000FF\\">?</span><span style=\\"color:#000000\\">&gt; </span><span style=\\"color:#001080\\">clazz</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#001080\\">jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">toClass</span><span style=\\"color:#000000\\">();</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        Object</span><span style=\\"color:#001080\\"> object</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#001080\\">clazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">newInstance</span><span style=\\"color:#000000\\">();</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //反射执行方法</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        clazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">getMethod</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"say\\"</span><span style=\\"color:#000000\\">,</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#267F99\\"> Class</span><span style=\\"color:#000000\\">[]{}).</span><span style=\\"color:#795E26\\">invoke</span><span style=\\"color:#000000\\">(object,</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#267F99\\"> Object</span><span style=\\"color:#000000\\">[]{});</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#008000\\">        //将生成的class写入文件中</span></span>\\n<span class=\\"line\\"><span style=\\"color:#267F99\\">        FileOutputStream</span><span style=\\"color:#001080\\"> fileOutputStream</span><span style=\\"color:#000000\\">=</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> FileOutputStream</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#AF00DB\\">new</span><span style=\\"color:#795E26\\"> File</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#A31515\\">\\"JATest.class\\"</span><span style=\\"color:#000000\\">));</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        fileOutputStream</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">write</span><span style=\\"color:#000000\\">(</span><span style=\\"color:#001080\\">jATestClazz</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">toBytecode</span><span style=\\"color:#000000\\">());</span></span>\\n<span class=\\"line\\"><span style=\\"color:#001080\\">        fileOutputStream</span><span style=\\"color:#000000\\">.</span><span style=\\"color:#795E26\\">close</span><span style=\\"color:#000000\\">();</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\">    }</span></span>\\n<span class=\\"line\\"><span style=\\"color:#000000\\">}</span></span>\\n<span class=\\"line\\"></span></code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{d as comp,v as data};
